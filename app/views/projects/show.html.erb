<div class="page-header">
  <div class="text-right">
    <%= link_to projects_path, class: 'btn btn-default' do %>
      All Projects
    <% end %>
    <%= link_to edit_project_path(@project), class: 'btn btn-primary' do %>
      Edit
    <% end %>
  </div>
  <h1 class="mt-3"><%= @project.name %></h1>
  <hr>
</div>

<section class="col-md-6 p-0">
  <h3>Tasks</h3>
  <div data-controller="forms">
    <%= form_with(
          model: [@project, @task],
          html: { data: { 
                  type: "html",
                  action: "ajax:error->forms#onSubmitError" }}) do |form| %>
      <div class="input-group mb-3">
        <%= form.text_field :content, class: 'form-control', placeholder: 'Add a task', data: { target: 'forms.input' } %>
        <div class="input-group-append">
          <%= form.submit 'Create', class: 'btn btn-primary', data: { target: 'forms.submitButton', disable_with: 'Creating...' } %>
        </div>
      </div>
      <div class="mb-3">
        <div data-target="forms.errorsList"></div>
      </div>
    <% end %>
  </div>

  <% if @project.tasks.any? %>
    <% @project.tasks.each do |task| %>
      <div class="card shadow-sm mb-3">
        <div class="card-body">
          <span class="badge <%= task.color %>"><%= task.status %></span>
          <h6 class="mt-2 mb-0"><%= task.content %></h6>
        </div>
      </div>
    <% end %>
  <% else %>
    <div class="mt-5">
      <h5 class="text-muted">Create your first task ☝️</h5>
    </div>
  <% end %>

</section>
